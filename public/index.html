<!DOCTYPE html>
<html>
<title>Madrid For All</title>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
  crossorigin="anonymous">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
<!-- link to the favicon genereated at https://www.favicon-generator.org/ -->
<link rel="shortcut icon" href="./assets/favicon.ico" type="image/x-icon">
<link rel="icon" href="./assets/favicon.ico" type="image/x-icon">
<!-- include necessary 3rd party javascript libraries -->
<script src="https://www.w3schools.com/lib/w3.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pouchdb@7.0.0/dist/pouchdb.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pouchdb@7.0.0/dist/pouchdb.find.min.js"></script>
<!-- development version, includes helpful console warnings -->
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<!-- production version, optimized for size and speed 
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
-->
<script src="./js/domain.js"></script>
<script>
    selectedLanguage = 'ES';
</script>
<style>
  body,
  h1,
  h2,
  h3,
  h4,
  h5 {
    font-family: "Poppins", sans-serif
  }

  body {
    font-size: 16px;
  }

  .w3-half img {
    margin-bottom: -6px;
    margin-top: 16px;
    opacity: 0.8;
    cursor: pointer
  }

  .w3-half img:hover {
    opacity: 1
  }
</style>

<!-- Matomo -->
<script type="text/javascript">
  var _paq = window._paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://analiticas.nodocomun.org/";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '24']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Matomo Code -->

</head>
<body>

  <div w3-include-html="./menu.html"></div>

  <!-- !PAGE CONTENT! -->
  <div class="w3-main" style="margin-left:390px;margin-right:40px">

    <!-- Header -->
    <!-- Servicios -->
    <div class="w3-container" style="margin-top:20px">
        <div class="w3-row w3-margin-bottom">
            <div class="w3-col s12 m11 l11 w3-left">
                <img src="./assets/madrid_for_all_header.png" alt="Madrid for all" class="w3-image" style="width:100%;max-width:600px">
                <div class="w3-hide-small">
                    <hr style="width:700px;border:3px solid #F2323E" class="w3-round">
                </div>
                <p>Selecciona una categoría o un servicio para ver dónde está y cómo puedes acceder</p>
            </div>
            <div class="w3-col s11 m2 l1 w3-right">
                <a href="./index.html" onClick="onLanguageChange('ES')">ES</a>
                <a href="./EN/index.html" onClick="onLanguageChange('EN')">EN</a>
                <a href="./FR/index.html" onClick="onLanguageChange('FR')">FR</a>
                <!--a href="./AR/index.html" onClick="onLanguageChange('AR')">AR</a-->
            </div>
    </div>

    <br>

    <div class="w3-container">
      <div id="servicesMap" style="width:100%;height:600px;"></div>
      <br>
      <div id="searchResults">
        <div id="resultCounter">
          {{message}}
        </div>
        <table id="resultTable" class="w3-table w3-striped w3-bordered">
          <thead>
            <tr>
              <th onclick="w3.sortHTML('#resultTable','.item', 'td:nth-child(1)')"></th>
            </tr>
          </thead>
          <tr v-for="loc in locations" class="item">
            <td>
              <div class="w3-row">
                <button v-bind:id="'loc-' + loc.ID" v-on:click="onLocationClick('' + loc.ID)" class="w3-button w3-col s11 m10 l10 w3-left w3-block w3-medium w3-left-align">{{loc.orgName}}</button>
                <a href="javascript:void(0)" class="w3-col w3-hide-small m2 l2 w3-padding w3-right-align" v-on:click="showLocationMarker('loc-marker-' + loc.ID)">Mostrar en el mapa</a>
                <a href="javascript:void(0)" class="w3-col w3-hide-large w3-hide-medium s1 w3-right-align" v-on:click="showLocationMarker('loc-marker-' + loc.ID)">+</a>
              </div>
              <div v-bind:id="'loc-' + loc.ID + '-details'" class="w3-hide loc-details">
                <div class="w3-row">
                  <a href="javascript:void(0)" v-on:click="openInfoTab('general-info-' + loc.ID);">
                    <div v-bind:id="'general-info-' + loc.ID + '-tablink'" class="w3-col s12 m4 l4 tablink w3-bottombar w3-padding">General</div>
                  </a>
                  <a href="javascript:void(0)" v-on:click="openInfoTab('contact-info-' + loc.ID);">
                    <div v-bind:id="'contact-info-' + loc.ID + '-tablink'" class="w3-col s12 m4 l4 tablink w3-bottombar w3-padding">Contacto y horarios</div>
                  </a>
                  <a href="javascript:void(0)" v-on:click="openInfoTab('extra-info-' + loc.ID);">
                    <div v-bind:id="'extra-info-' + loc.ID + '-tablink'" class="w3-col s12 m4 l4 tablink w3-bottombar w3-padding">Información adicional</div>
                  </a>
                </div>
                <div class="w3-row">
                  <div v-bind:id="'general-info-' + loc.ID" class="w3-col s12 m4 l4 infoTab" style="display:none; width:100%">
                    <p>Distrito: {{loc.district}}</p>
                    <p>Categorias: <div v-if="loc.categories">{{printCategories(loc.categories)}}</p>
                    <p>Servicios: <div v-if="loc.services">{{printServices(loc.services)}} </div></p>
                  </div>
                  <div v-bind:id="'contact-info-' + loc.ID" class="w3-col s12 m4 l4 infoTab" style="display:none; width:100%">
                    <p>Dirección: {{loc.fullAddress}}</p>
                    <p>Medios de contacto preferidos: {{loc.waysOfContact}}</p>
                    <p>Horarios: {{loc.timeTable}}</p>
                  </div>
                  <div v-bind:id="'extra-info-' + loc.ID" class="w3-col s12 m4 l4 infoTab" style="display:none; width:100%">
                    <p>{{loc.additionalInfo}}</p>
                  </div>
                </div> 
              </div>
          </td>
          </tr>
          </table>
      </div>
    </div>
    <!-- Pagination 
    <div class="w3-center">
      <div class="w3-bar">
        <a href="#" class="w3-bar-item w3-button">&laquo;</a>
        <a href="#" class="w3-button">1</a>
        <a href="#" class="w3-button">2</a>
        <a href="#" class="w3-button">3</a>
        <a href="#" class="w3-button">4</a>
        <a href="#" class="w3-button">&raquo;</a>
      </div>
    </div>
    -->
  </div>
  <!-- End page content / w3-main -->
  <!-- Footer -->
  <div w3-include-html="./footer.html"></div>
  
  <script>
    // destroy DB in order to recreate it from scratch
    db.destroy().then(
      function () {
        // Once we destroy the database, we have to create a new one otherwise we'll get an error, "Error: database is destroyed".
        db = new PouchDB(dbName);
        // initialize page content by loading its associated 'data.js'
        w3.getHttpObject("/data/categories.json", initMenuContent);
      }
    )
    // Post DOM loaded actions
    // include the HTML in separated files
    w3.includeHTML();
    // sort results table by column #1
    w3.sortHTML('#resultTable', '.item', 'td:nth-child(1)');
  </script>
  <!-- async load / call external js scripts -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA-cYGCy5xyn4C5hH0rv7iWbw4nNGqcU0E&callback=loadMap"></script>
  <script src="./js/controller.js"></script>

</body>

</html>